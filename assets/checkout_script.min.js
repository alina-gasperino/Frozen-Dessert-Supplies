function displayAllRates(){jQuery(expeditedResidentialSelector).parent().parent().parent().show(),jQuery(freeResidentialSelector).parent().parent().parent().show(),jQuery(expeditedCommercialSelector).parent().parent().parent().show(),jQuery(freeCommercialSelector).parent().parent().parent().show(),jQuery(freeDropShipCommercialSelector).parent().parent().parent().show(),jQuery(freeDropShipResidentialSelector).parent().parent().parent().show()}function hideAllRates(){jQuery(expeditedResidentialSelector).parent().parent().parent().hide(),jQuery(freeResidentialSelector).parent().parent().parent().hide(),jQuery(expeditedCommercialSelector).parent().parent().parent().hide(),jQuery(freeCommercialSelector).parent().parent().parent().hide(),jQuery(freeDropShipCommercialSelector).parent().parent().parent().hide(),jQuery(freeDropShipResidentialSelector).parent().parent().parent().hide(),jQuery(dropShipCommercialSelector).parent().parent().parent().hide(),jQuery(dropShipResidentialSelector).parent().parent().parent().hide()}function displayCommercialRates(){jQuery(expeditedResidentialSelector).parent().parent().parent().hide(),jQuery(freeResidentialSelector).parent().parent().parent().hide(),jQuery(freeDropShipResidentialSelector).parent().parent().parent().hide(),jQuery(dropShipResidentialSelector).parent().parent().parent().hide();let e=jQuery(mostPopularOption);e.parent().parent().parent().show(),e.trigger("click"),jQuery(expeditedCommercialSelector).parent().parent().parent().show(),jQuery(freeCommercialSelector).parent().parent().parent().show(),jQuery(freeDropShipCommercialSelector).parent().parent().parent().show(),jQuery(dropShipCommercialSelector).parent().parent().parent().show()}function displayResidentialRates(){jQuery(expeditedCommercialSelector).parent().parent().parent().hide(),jQuery(freeCommercialSelector).parent().parent().parent().hide(),jQuery(freeDropShipCommercialSelector).parent().parent().parent().hide(),jQuery(dropShipCommercialSelector).parent().parent().parent().hide();let e=jQuery(expeditedResidentialSelector);e.parent().parent().parent().show(),e.trigger("click"),jQuery(expeditedResidentialSelector).parent().parent().parent().show(),jQuery(freeResidentialSelector).parent().parent().parent().show(),jQuery(freeDropShipResidentialSelector).parent().parent().parent().show(),jQuery(dropShipResidentialSelector).parent().parent().parent().show()}function revealTaxInfo(){let e=document.getElementById("tax-info-shadow");e.classList.toggle("visible")}function openDropdown(){jQuery("#myDropdown").toggleClass("show")}function _shippingLoaded(){if(0==jQuery('[name="checkout[shipping_rate][id]"]').length)setTimeout(_shippingLoaded,100);else{function e(){const e=document.querySelector("fieldset.content-box"),t=document.createElement("div");t.className="checkout-dropdown-wrapper";const a=document.createElement("span");a.onclick=(e=>{document.getElementById("checkout-dropdown").classList.toggle("show-checkout-option"),document.querySelector("fieldset.content-box").classList.toggle("additional-bottom-padding"),document.querySelector("fieldset.content-box").classList.toggle("default-bottom-padding");for(const e of document.getElementsByClassName("checkout-placeholder"))e.classList.toggle("invisible-placeholder");"More Shipping Options"===e.target.innerText?e.target.innerText="Hide Additional Shipping Options":e.target.innerText="More Shipping Options"}),a.id="checkout-options-btn",a.innerText="More Shipping Options";const s=document.createElement("div");s.className="checkout-dropdown-options",s.id="checkout-dropdown",e.appendChild(t),t.appendChild(a),t.appendChild(s);const d=[],r=[...e.children].filter(e=>"content-box__row"===e.className);for(const t of r){const a=[...t.children].find(e=>"radio-wrapper"===e.className);if(a){const r=[...a.children].find(e=>"radio__input"===e.className);if(r){const a=[...r.children].find(e=>e.checked);if(!a){e.removeChild(t);const a=t.cloneNode(!0);a.style="visibility: hidden;",a.classList.add("invisible-placeholder"),a.classList.add("checkout-placeholder"),d.push(a),s.appendChild(t)}}}}for(const t of d)e.appendChild(t);document.querySelector("fieldset.content-box").classList.toggle("default-bottom-padding")}hideAllRates(),jQuery('span[data-shipping-method-label-title="UPS Ground"]').text("2-4 Business Days (MOST POPULAR)"),jQuery('span[data-shipping-method-label-title="2-4 Business Days (MOST POPULAR)"]').is(":visible")&&(document.getElementsByClassName("input-radio")[2].checked=!0,e()),jQuery('span[data-shipping-method-label-title="UPS Ground"]').is(":visible")&&(document.getElementsByClassName("input-radio")[2].checked=!0,e());var t=document.querySelector("#shipping-address").dataset;const a=new Request("https://api.frozendessertsupplies.company/get-address-classification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});fetch(a).then(e=>{if(200!==e.status)throw displayResidentialRates(),new Error("Something went wrong on api server!");e.json().then(e=>{switch(e.code){case 1:displayCommercialRates();break;default:jQuery('span[data-shipping-method-label-title="6-10 Business Days - Commercial Address"]').is(":hidden")&&(document.getElementsByClassName("input-radio")[1].checked=!0),displayResidentialRates()}})}).catch(e=>{displayAllRates(),console.error(e)})}}function addressValidatorGetShippingAddressHTML(e){let t=e.changes&&0!==e.changes.length?`<div class="address" onclick="updateAddressFromVanillaClickAndSubmit(event)" data-changes="${JSON.stringify(e.changes).replace(/"/g,"'")}" valid="${e.valid}">`:'<div class="address">';return t+=`\n            <span class="address1">${e.address.address1}</span>\n            <span class="address2">${e.address.address2}</span>\n            <div>\n                <span class="city">${e.address.city}</span>,\n                <span class="provinceCode">${e.address.provinceCode}</span>\n                <span class="zip">${e.address.zip}</span>\n            </div>\n        </div>\n    `,t}function candidateHoverOffHandler(e){jQuery("#address-validator-popup .addresses>.original .displayChange").removeClass("displayChange")}function candidateHoverInHandler(e){let t=jQuery(e.currentTarget).data("changes");JSON.parse(t.replace(/'/g,'"'))}function updateAddressFromClickAndSubmit(){jQuery("#address-validator-overlay").removeClass("visible"),jQuery("#continue_button").addClass("btn--loading"),document.getElementById("checkout_shipping_address_address1").value=jQuery(this).find(".address1").text(),document.getElementById("checkout_shipping_address_address2").value=jQuery(this).find(".address2").text(),document.getElementById("checkout_shipping_address_city").value=jQuery(this).find(".city").text(),document.getElementById("checkout_shipping_address_province").value=jQuery(this).find(".provinceCode").text(),document.getElementById("checkout_shipping_address_zip").value=jQuery(this).find(".zip").text(),jQuery(".addresses").removeClass("visible"),jQuery("#address-validator-popup").data("validated",!0),jQuery(".main__content>.step>.edit_checkout").submit()}function updateAddressFromVanillaClickAndSubmit(e){let t=e.target;for(;"address"!==t.className;)t=t.parentElement;const[a,s,d]=t.children,[r,n,i]=d.children;jQuery("#address-validator-overlay").removeClass("visible"),jQuery("#continue_button").addClass("btn--loading"),document.getElementById("checkout_shipping_address_address1").value=a.innerText,document.getElementById("checkout_shipping_address_address2").value=s.innerText,document.getElementById("checkout_shipping_address_city").value=r.innerText,document.getElementById("checkout_shipping_address_province").value=n.innerText,document.getElementById("checkout_shipping_address_zip").value=i.innerText,jQuery(".addresses").removeClass("visible"),jQuery("#address-validator-popup").data("validated",!0),jQuery(".main__content>.step>.edit_checkout").submit()}function updateAddressAndSubmit(){jQuery("#address-validator-overlay").removeClass("visible"),jQuery("#continue_button").addClass("btn--loading"),document.getElementById("checkout_shipping_address_address1").value=correctedAddresses[0].address.address1.trim(),document.getElementById("checkout_shipping_address_address2").value=correctedAddresses[0].address.address2.trim(),document.getElementById("checkout_shipping_address_city").value=correctedAddresses[0].address.city.trim(),document.getElementById("checkout_shipping_address_province").value=correctedAddresses[0].address.provinceCode.trim(),document.getElementById("checkout_shipping_address_zip").value=correctedAddresses[0].address.zip.trim(),jQuery(".addresses").removeClass("visible"),jQuery("#address-validator-popup").data("validated",!0),jQuery(".main__content>.step>.edit_checkout").submit()}function different(e,t){for(var a=0,s=e.length>t.length?t.length:e.length,d=e.length<t.length?t.length:e.length,r=0;r<s;r++)e[r]==t[r]&&a++;var n=a/d;return 1-n}function injectCSS(e){const t=document.createElement("style");t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)}const freeCommercialSelector='label>span[data-shipping-method-label-title="5+ Business Days - Commercial Address"]',freeResidentialSelector='label>span[data-shipping-method-label-title="5+ Business Days - Residential Address"]',expeditedCommercialSelector='label>span[data-shipping-method-label-title="3-4 Business Days - Commercial Address"]',expeditedResidentialSelector='label>span[data-shipping-method-label-title="3-4 Business Days - Residential Address"]',freeDropShipCommercialSelector='label>span[data-shipping-method-label-title="5+ Business Days - Commercial Address"]',freeDropShipResidentialSelector='label>span[data-shipping-method-label-title="5+ Business Days - Residential Address"]',dropShipCommercialSelector='label>span[data-shipping-method-label-title="6-10 Business Days - Commercial Address"]',dropShipResidentialSelector='label>span[data-shipping-method-label-title="6-10 Business Days - Residential Address"]',mostPopularOption='label>span[data-shipping-method-label-title="2-4 Business Days (MOST POPULAR)"]';jQuery("#address-validator-overlay #drop-down").click(openDropdown);let correctedAddresses=[];if("shipping_method"==Shopify.Checkout.step){console.log("before shipping_method"),_shippingLoaded();var css="#checkout-options-btn {\n    color: #26bfcb;\n    padding: 8px;\n    font-size: 12px;\n    border: 1px solid #26bfcb;\n    border-radius: 5px;\n    cursor: pointer;\n    margin-top: 32px;\n    margin-left: 16px;\n    /* Disable text selection on click */\n    -webkit-user-select: none; /* Safari */\n    -ms-user-select: none; /* IE 10 and IE 11 */\n    user-select: none; /* Standard syntax */\n  }\n  /* Hover effects (not implemented)\n  #checkout-options-btn:hover,\n  #checkout-options-btn:focus {\n    background-color: #2980B9;\n  } */\n  .checkout-dropdown-wrapper {\n    position: relative;\n    display: inline-block;\n    width: 100%;\n    margin-left: 16px;\n    /* Disable text selection on click */\n    -webkit-user-select: none; /* Safari */\n    -ms-user-select: none; /* IE 10 and IE 11 */\n    user-select: none; /* Standard syntax */\n  }\n  .checkout-dropdown-options {\n    display: none;\n    position: absolute;\n    margin-top: 24px;\n    width: calc(100% - 32px); /* Accounts for left padding */\n    min-width: 160px;\n    z-index: 1;\n  }\n  .checkout-dropdown-options div {\n    text-decoration: none;\n    display: block;\n  }\n  .checkout-dropdown-options div:hover {\n    background-color: #ddd;\n  }\n  .show-checkout-option {\n    display: block;\n  }\n  .invisible-placeholder {\n    display: none !important;\n  }\n  .default-bottom-padding {\n    padding-bottom: 24px;\n  }\n  .additional-bottom-padding {\n    padding-bottom: 36px;\n  }";injectCSS(css)}jQuery("#cancel-button").click(()=>{jQuery("#address-validator-overlay").removeClass("visible"),jQuery("#address-validator-popup .candidates-wrapper>h4").text(""),jQuery("#address-validator-popup #candidates").empty(),jQuery("#address-validator-popup .addresses>.original>.address").empty(),jQuery("#continue_button").prop("disabled",!1),jQuery(".addresses").removeClass("visible"),jQuery("#address-validator-popup").data("secondAttempt",!0)}),jQuery("#proceed").click(()=>{let e=document.getElementById("acknowledgement_checkbox").checked;e?(jQuery("#address-validator-popup").data("validated",!0),jQuery(".main__content>.step>.edit_checkout").submit()):alert("Please accept this policy before continuing.")}),"contact_information"==Shopify.Checkout.step&&jQuery(".main__content>.step>.edit_checkout").submit(e=>{var t=jQuery("#address-validator-popup").data("validated");if(!t){e.preventDefault();let t=document.getElementById("checkout_shipping_address_country"),a={firstName:document.getElementById("checkout_shipping_address_first_name").value,lastName:document.getElementById("checkout_shipping_address_last_name").value,address1:document.getElementById("checkout_shipping_address_address1").value,address2:document.getElementById("checkout_shipping_address_address2").value,company:document.getElementById("checkout_shipping_address_company").value,city:document.getElementById("checkout_shipping_address_city").value,countryCode:t[t.selectedIndex].getAttribute("data-code"),provinceCode:document.getElementById("checkout_shipping_address_province").value,zip:document.getElementById("checkout_shipping_address_zip").value,phone:document.getElementById("checkout_shipping_address_phone").value};const s=new Request("https://api.frozendessertsupplies.company/validate-address",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});fetch(s).then(t=>{if(200!==t.status)throw new Error("Something went wrong on api server!");t.json().then(t=>{let s=[],d=JSON.parse(t.finalCandidate),r=JSON.parse(t.finalAddressInfo),n=r.poBox;for(let t of d){let d=[],r=0;for(let e in t.address){let s=different(a[e].toUpperCase(),t.address[e].toUpperCase());s>0&&(d.push({field:e,weight:s}),r+=s)}if(0===r&&t.valid&&!1===n)return jQuery("#address-validator-popup").data("validated",!0),void e.currentTarget.submit();s.push({address:t.address,changes:d,changeWeight:r,valid:t.valid,invalidReason:t.invalidReason})}correctedAddresses=s;let i=!1,o="";var l=jQuery("#address-validator-popup").data("secondAttempt");!0===n&&(o="We're sorry, we do not ship to P.O. Boxes as our shipments are too large. Please update your address and try again. If you have any issues please contact our customer service team.",l=!1,i=!1),jQuery("#address-validator-overlay").addClass("visible"),s.length<=0?(console.log(`Address Candidates Length: ${s.length}`),l=!0,jQuery("#update-address").removeClass("visible"),jQuery("#continue_button").removeClass("btn--loading"),jQuery("#cancel-button").addClass("noCandidates")):(jQuery("#update-address").addClass("visible"),jQuery("#cancel-button").removeClass("noCandidates"),jQuery("#continue_button").removeClass("btn--loading"),jQuery("#address-validator-popup .addresses>.original>.address").replaceWith(addressValidatorGetShippingAddressHTML({address:a}))),l&&s.length<=0?(jQuery("#proceed").addClass("visible"),jQuery("#cancel-button").addClass("noCandidates"),jQuery(".acknowledgement").addClass("visible"),jQuery("#update-address").removeClass("visible"),jQuery("#continue_button").removeClass("btn--loading")):l&&(jQuery("#cancel-button").removeClass("noCandidates"),jQuery("#proceed").addClass("visible"),jQuery(".acknowledgement").addClass("visible"),jQuery("#update-address").addClass("visible"),jQuery("#address-validator-overlay #address-validator-popup .dropdown-wrapper").removeClass("withButton")),s.length>1?(jQuery("#address-validator-overlay #drop-down").addClass("visible"),jQuery("#address-validator-overlay #address-validator-popup .dropdown-wrapper").addClass("withButton")):(jQuery("#address-validator-overlay #drop-down").removeClass("visible"),jQuery("#address-validator-overlay #address-validator-popup .dropdown-wrapper").removeClass("withButton")),0===s.length?o=l?"Looks like our system can't correctly identify your complete address. If you proceed you may incur UPS invalid address fees. If you are worried about this message and would like more clarification from the Customer Solutions team please give us a call at (480)428-1999. Check this box if you would still like to proceed and be at risk of invalid address fees.":"Please update your address and try again.":1===s.length?"Address Line 2 is Missing partially or completely"===s[0].invalidReason||"Address line 2 is missing an Apt/Unit number"===s[0].invalidReason?o=l?"Looks like our system still can't correctly identify your complete address. If you proceed without updating you may incur UPS invalid address fees. If you are worried about this message and would like more clarification from the Customer Solutions team please give us a call at (480)428-1999. Check this box if you would still like to proceed and be at risk of invalid address fees.":"You are missing an apartment/suite number. Please update your address and try again.":"Address Line 2 is present but is not correct"===s[0].invalidReason&&!1===n?o=l?"Looks like our system still can't correctly identify your complete address. If you proceed without updating you may incur UPS invalid address fees. If you are worried about this message and would like more clarification from the Customer Solutions team please give us a call at (480)428-1999. Check this box if you would still like to proceed and be at risk of invalid address fees.":"Your apartment/suite number is incorrect please verify address and try again.":0!==s[0].changeWeight&&!1===n&&(jQuery("#address-validator-popup .candidates-wrapper>h4").text("Corrected address:"),i=!0):(jQuery("#address-validator-popup .candidates-wrapper>h4").text("Corrected addresses:"),i=!0),i&&(o=l?"Looks like our system still can't correctly identify your complete address. If you proceed without updating you may incur UPS invalid address fees. If you are worried about this message and would like more clarification from the Customer Solutions team please give us a call at (480) 428-1999. Check this box if you would still like to proceed and be at risk of invalid address fees. Or click Update Address Below.":"To ensure prompt and accurate delivery, we suggest a modified shipping address. Click Update Address to select this suggestion.",jQuery(".addresses").addClass("visible"),s.sort((e,t)=>e.changeWeight>t.changeWeight?1:-1),jQuery("#address-validator-popup #candidates").empty(),jQuery("#address-validator-popup #candidates").append(addressValidatorGetShippingAddressHTML(s[0])),jQuery("#myDropdown").append(s.slice(1,s.length).map(e=>addressValidatorGetShippingAddressHTML(e)).join("")),window.onclick=function(e){if(!e.target.matches(".dropbtn")){var t,a=document.getElementsByClassName("dropdown-content");for(t=0;t<a.length;t++){var s=a[t];s.classList.contains("show")&&s.classList.remove("show")}}},jQuery("#address-validator-overlay #candidates .address").each((e,t)=>{let a=jQuery(t).data("changes"),s=JSON.parse(a.replace(/'/g,'"'));for(let e of s)jQuery(t).find(`.${e.field}`).addClass("displayChange")}),jQuery("#address-validator-overlay #candidates .address").hover(candidateHoverInHandler,candidateHoverOffHandler),jQuery("#address-validator-overlay #candidates .address").click(updateAddressFromClickAndSubmit),jQuery("#address-validator-overlay #update-address").click(updateAddressAndSubmit),jQuery("#address-validator-overlay #myDropdown .show .address").click(updateAddressFromClickAndSubmit)),jQuery("#address-validator-message").text(o)})}).catch(e=>{console.error(e)})}});